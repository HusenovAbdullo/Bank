import{d as A,f as P,r as p,J as j,g as E,z as R,h as w,i as c,t as f,j as s,u as r,w as u,C as T,K as N,F as U,l as F,o as x,v as b,k as _,_ as M}from"./index-DrwtuItr.js";import{T as X,c as B,i as I}from"./tabulator_esm-DCtBT1lt.js";import{_ as v}from"./Button.vue_vue_type_script_setup_true_lang-BEdiinS3.js";import{x as J}from"./xlsx-DVFzcVXd.js";const G={class:"intro-y box p-5 mt-5"},H={class:"flex items-center justify-between"},K={class:"text-lg font-medium"},O={class:"mt-5 flex gap-2 flex-wrap items-center"},q=["value"],Q={class:"overflow-x-auto scrollbar-hidden mt-5"},ae=A({__name:"AddProduct",setup(W){const{t:i}=P(),g=p(),n=p(),l=j({barcode:"",last_event_name:""}),d=p(10),y=async()=>{const e=localStorage.getItem("token");if(!e){alert("Token topilmadi. Iltimos, tizimga kiring.");return}g.value&&(n.value=new X(g.value,{ajaxURL:"https://treking.uz/barcode-all/",ajaxConfig:{method:"GET",headers:{Authorization:`Bearer ${e}`}},ajaxResponse:(t,o,m)=>({data:m.results.map(a=>{var h;return{barcode:a.barcode,weight:a.weight,sent_date:a.send_date?new Date(a.send_date).toLocaleDateString():"-",received_date:a.received_date?new Date(a.received_date).toLocaleDateString():"-",last_event_date:a.last_event_date?new Date(a.last_event_date).toLocaleDateString():"-",last_event_name:((h=a.last_event_name)==null?void 0:h.slice(-1)[0])||"-",city:a.city||"-"}}),last_page:Math.ceil(m.count/d.value)}),layout:"fitColumns",pagination:!0,paginationSize:d.value,paginationMode:"remote",placeholder:"No matching records found",columns:[{title:i("barcode"),field:"barcode",hozAlign:"center"},{title:i("weight"),field:"weight",hozAlign:"center"},{title:i("sent_date"),field:"sent_date",hozAlign:"center"},{title:i("received_date"),field:"received_date",hozAlign:"center"},{title:i("last_event_date"),field:"last_event_date",hozAlign:"center"},{title:i("last_event_name"),field:"last_event_name",hozAlign:"center"},{title:i("city"),field:"city",hozAlign:"center"}],ajaxURLGenerator:function(t,o,m){const a=new URLSearchParams;return a.set("page",m.page),a.set("page_size",d.value.toString()),l.barcode&&a.set("barcode",l.barcode),l.last_event_name&&a.set("last_event_name",l.last_event_name),`${t}?${a.toString()}`}}),n.value.on("renderComplete",()=>{B({icons:I,attrs:{"stroke-width":1.5},nameAttr:"data-lucide"})}))},k=()=>{n.value&&(n.value.setPage(1),n.value.setData())},S=()=>{var e,t;l.barcode="",l.last_event_name="",(e=n.value)==null||e.setPage(1),(t=n.value)==null||t.setData()},z=()=>{var e;return(e=n.value)==null?void 0:e.setPageSize(d.value)};E(()=>{y(),window.addEventListener("resize",()=>{var e;return(e=n.value)==null?void 0:e.redraw()})}),R(d,()=>z());const C=()=>{var e;return(e=n.value)==null?void 0:e.download("csv","data.csv")},D=()=>{var e;return(e=n.value)==null?void 0:e.download("json","data.json")},L=()=>{var e;window.XLSX=J,(e=n.value)==null||e.download("xlsx","data.xlsx",{sheetName:"Data"})},V=()=>{var e;return(e=n.value)==null?void 0:e.download("html","data.html",{style:!0})},$=()=>{var e;return(e=n.value)==null?void 0:e.print()};return(e,t)=>(x(),w("div",G,[c("div",H,[c("h2",K,f(e.$t("statuses_statistics")),1)]),c("div",O,[s(r(b),{modelValue:l.barcode,"onUpdate:modelValue":t[0]||(t[0]=o=>l.barcode=o),style:{width:"250px"},placeholder:e.$t("search_barcode")},null,8,["modelValue","placeholder"]),s(r(b),{modelValue:l.last_event_name,"onUpdate:modelValue":t[1]||(t[1]=o=>l.last_event_name=o),style:{width:"250px"},placeholder:e.$t("search_last_event_name")},null,8,["modelValue","placeholder"]),s(r(v),{onClick:k},{default:u(()=>[_(f(e.$t("go")),1)]),_:1}),s(r(v),{variant:"secondary",onClick:S},{default:u(()=>[_(f(e.$t("reset")),1)]),_:1}),s(r(v),{variant:"outline-secondary",onClick:$},{default:u(()=>[s(r(M),{icon:"Printer",class:"w-4 h-4 mr-2"}),t[3]||(t[3]=_(" Print "))]),_:1}),s(r(v),{variant:"outline-secondary",onClick:C},{default:u(()=>t[4]||(t[4]=[_("CSV")])),_:1}),s(r(v),{variant:"outline-secondary",onClick:D},{default:u(()=>t[5]||(t[5]=[_("JSON")])),_:1}),s(r(v),{variant:"outline-secondary",onClick:L},{default:u(()=>t[6]||(t[6]=[_("XLSX")])),_:1}),s(r(v),{variant:"outline-secondary",onClick:V},{default:u(()=>t[7]||(t[7]=[_("HTML")])),_:1}),T(c("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>d.value=o),class:"form-select ml-auto w-20"},[(x(),w(U,null,F([10,20,50,100],o=>c("option",{key:o,value:o},f(o),9,q)),64))],512),[[N,d.value]])]),c("div",Q,[c("div",{ref_key:"tableRef",ref:g},null,512)])]))}});export{ae as default};
