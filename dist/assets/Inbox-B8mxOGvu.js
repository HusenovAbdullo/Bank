import{d as T,r as _,A as R,z as D,g as V,h as p,i as s,t as m,j as i,u as n,w as r,B as $,C as N,F as j,l as B,o as g,v as E,k as d,_ as F}from"./index-Tdtmmhim.js";import{T as L,c as I,i as M,x as P}from"./xlsx-DAllgAbK.js";import{_ as c}from"./Button.vue_vue_type_script_setup_true_lang-DdNVJ4XG.js";import{a as X}from"./axios-D4YhIzwJ.js";const H={class:"intro-y box p-5 mt-5"},J={class:"flex items-center justify-between"},U={class:"text-lg font-medium"},W={class:"mt-5 flex gap-2 flex-wrap items-center"},q=["value"],G={class:"overflow-x-auto scrollbar-hidden mt-5"},te=T({__name:"Inbox",setup(K){const v=_(),a=_(),f=_(10),u=R({field:"batch",type:"like",value:""}),w=async()=>{const e=localStorage.getItem("token");if(!e){alert("Token topilmadi. Iltimos, tizimga kiring.");return}try{const l=(await X.get("https://treking.uz/batch-statistics/",{headers:{Authorization:`Bearer ${e}`}})).data.batch_statistics,S=Object.entries(l).map(([O,h])=>{const o=h.status_counts;return{batch:O,total:h.total_count,on_way:o["On way"]||o["On Way"]||0,exchange_office:o["Arrived at office of exchange"]||0,send_customs:o.sent_to_customs||o["Send to customs"]||0,return_customs:o["Return from customs"]||0,domestic_location:o["Send to domestic location"]||0,delivery_office:o["Receive at delivery office"]||0,ready_delivery:o["Ready for Delivery"]||0,out_delivery:o.out_for_delivery||o["Out for delivery"]||0,deliver_item:o["Deliver item"]||0}});v.value&&(a.value=new L(v.value,{data:S,layout:"fitColumns",pagination:!0,paginationSize:f.value,paginationMode:"local",placeholder:"No matching records found",columns:[{title:"BATCH NO.",field:"batch",hozAlign:"center"},{title:"TOTAL",field:"total",hozAlign:"center"},{title:"On way",field:"on_way",hozAlign:"center"},{title:"Arrived at office of exchange",field:"exchange_office",hozAlign:"center"},{title:"Send to customs",field:"send_customs",hozAlign:"center"},{title:"Return from customs",field:"return_customs",hozAlign:"center"},{title:"Send to domestic location",field:"domestic_location",hozAlign:"center"},{title:"Receive at delivery office",field:"delivery_office",hozAlign:"center"},{title:"Ready for Delivery",field:"ready_delivery",hozAlign:"center"},{title:"Out for delivery",field:"out_delivery",hozAlign:"center"},{title:"Deliver item",field:"deliver_item",hozAlign:"center"}]}),a.value.on("renderComplete",()=>{I({icons:M,attrs:{"stroke-width":1.5},nameAttr:"data-lucide"})}))}catch(t){console.error("API dan ma'lumot olishda xatolik:",t),alert("Ma'lumot yuklab bo'lmadi. Token noto'g'ri yoki muddati o'tgan bo'lishi mumkin.")}},y=()=>{var e;return(e=a.value)==null?void 0:e.setFilter(u.field,u.type,u.value)},x=()=>{Object.assign(u,{field:"batch",type:"like",value:""}),y()},k=()=>{var e;return(e=a.value)==null?void 0:e.download("csv","data.csv")},b=()=>{var e;return(e=a.value)==null?void 0:e.download("json","data.json")},A=()=>{var e;window.XLSX=P,(e=a.value)==null||e.download("xlsx","data.xlsx",{sheetName:"Data"})},z=()=>{var e;return(e=a.value)==null?void 0:e.download("html","data.html",{style:!0})},C=()=>{var e;return(e=a.value)==null?void 0:e.print()};return D(f,()=>{var e;(e=a.value)==null||e.setPageSize(f.value)}),V(()=>{w(),window.addEventListener("resize",()=>{var e;return(e=a.value)==null?void 0:e.redraw()})}),(e,t)=>(g(),p("div",H,[s("div",J,[s("h2",U,m(e.$t("batch_statistics")),1)]),s("div",W,[i(n(E),{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),style:{width:"250px"},placeholder:e.$t("search_batch")},null,8,["modelValue","placeholder"]),i(n(c),{onClick:y},{default:r(()=>[d(m(e.$t("go")),1)]),_:1}),i(n(c),{variant:"secondary",onClick:x},{default:r(()=>[d(m(e.$t("reset")),1)]),_:1}),i(n(c),{variant:"outline-secondary",onClick:C},{default:r(()=>[i(n(F),{icon:"Printer",class:"w-4 h-4 mr-2"}),t[2]||(t[2]=d(" Print "))]),_:1}),i(n(c),{variant:"outline-secondary",onClick:k},{default:r(()=>t[3]||(t[3]=[d("CSV")])),_:1}),i(n(c),{variant:"outline-secondary",onClick:b},{default:r(()=>t[4]||(t[4]=[d("JSON")])),_:1}),i(n(c),{variant:"outline-secondary",onClick:A},{default:r(()=>t[5]||(t[5]=[d("XLSX")])),_:1}),i(n(c),{variant:"outline-secondary",onClick:z},{default:r(()=>t[6]||(t[6]=[d("HTML")])),_:1}),$(s("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),class:"form-select ml-auto w-20"},[(g(),p(j,null,B([10,20,50,100],l=>s("option",{key:l,value:l},m(l),9,q)),64))],512),[[N,f.value]])]),s("div",G,[s("div",{ref_key:"tableRef",ref:v},null,512)])]))}});export{te as default};
