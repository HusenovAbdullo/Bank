import{d as T,r as _,J as R,z as D,g as V,h,i as s,t as m,j as l,u as n,w as r,C as $,K as N,F as j,l as E,o as g,v as F,k as d,_ as L}from"./index-DrwtuItr.js";import{T as B,c as I,i as M}from"./tabulator_esm-DCtBT1lt.js";import{_ as c}from"./Button.vue_vue_type_script_setup_true_lang-BEdiinS3.js";import{a as P}from"./axios-D4YhIzwJ.js";import{x as X}from"./xlsx-DVFzcVXd.js";const H={class:"intro-y box p-5 mt-5"},J={class:"flex items-center justify-between"},U={class:"text-lg font-medium"},K={class:"mt-5 flex gap-2 flex-wrap items-center"},W=["value"],q={class:"overflow-x-auto scrollbar-hidden mt-5"},oe=T({__name:"Inbox",setup(G){const v=_(),a=_(),f=_(10),u=R({field:"batch",type:"like",value:""}),w=async()=>{const e=localStorage.getItem("token");if(!e){alert("Token topilmadi. Iltimos, tizimga kiring.");return}try{const i=(await P.get("https://treking.uz/batch-statistics/",{headers:{Authorization:`Bearer ${e}`}})).data.batch_statistics,S=Object.entries(i).map(([O,p])=>{const o=p.status_counts;return{batch:O,total:p.total_count,on_way:o["On way"]||o["On Way"]||0,exchange_office:o["Arrived at office of exchange"]||0,send_customs:o.sent_to_customs||o["Send to customs"]||0,return_customs:o["Return from customs"]||0,domestic_location:o["Send to domestic location"]||0,delivery_office:o["Receive at delivery office"]||0,ready_delivery:o["Ready for Delivery"]||0,out_delivery:o.out_for_delivery||o["Out for delivery"]||0,deliver_item:o["Deliver item"]||0}});v.value&&(a.value=new B(v.value,{data:S,layout:"fitColumns",pagination:!0,paginationSize:f.value,paginationMode:"local",placeholder:"No matching records found",columns:[{title:"BATCH NO.",field:"batch",hozAlign:"center"},{title:"TOTAL",field:"total",hozAlign:"center"},{title:"On way",field:"on_way",hozAlign:"center"},{title:"Arrived at office of exchange",field:"exchange_office",hozAlign:"center"},{title:"Send to customs",field:"send_customs",hozAlign:"center"},{title:"Return from customs",field:"return_customs",hozAlign:"center"},{title:"Send to domestic location",field:"domestic_location",hozAlign:"center"},{title:"Receive at delivery office",field:"delivery_office",hozAlign:"center"},{title:"Ready for Delivery",field:"ready_delivery",hozAlign:"center"},{title:"Out for delivery",field:"out_delivery",hozAlign:"center"},{title:"Deliver item",field:"deliver_item",hozAlign:"center"}]}),a.value.on("renderComplete",()=>{I({icons:M,attrs:{"stroke-width":1.5},nameAttr:"data-lucide"})}))}catch(t){console.error("API dan ma'lumot olishda xatolik:",t),alert("Ma'lumot yuklab bo'lmadi. Token noto'g'ri yoki muddati o'tgan bo'lishi mumkin.")}},y=()=>{var e;return(e=a.value)==null?void 0:e.setFilter(u.field,u.type,u.value)},x=()=>{Object.assign(u,{field:"batch",type:"like",value:""}),y()},k=()=>{var e;return(e=a.value)==null?void 0:e.download("csv","data.csv")},b=()=>{var e;return(e=a.value)==null?void 0:e.download("json","data.json")},A=()=>{var e;window.XLSX=X,(e=a.value)==null||e.download("xlsx","data.xlsx",{sheetName:"Data"})},z=()=>{var e;return(e=a.value)==null?void 0:e.download("html","data.html",{style:!0})},C=()=>{var e;return(e=a.value)==null?void 0:e.print()};return D(f,()=>{var e;(e=a.value)==null||e.setPageSize(f.value)}),V(()=>{w(),window.addEventListener("resize",()=>{var e;return(e=a.value)==null?void 0:e.redraw()})}),(e,t)=>(g(),h("div",H,[s("div",J,[s("h2",U,m(e.$t("batch_statistics")),1)]),s("div",K,[l(n(F),{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=i=>u.value=i),style:{width:"250px"},placeholder:e.$t("search_batch")},null,8,["modelValue","placeholder"]),l(n(c),{onClick:y},{default:r(()=>[d(m(e.$t("go")),1)]),_:1}),l(n(c),{variant:"secondary",onClick:x},{default:r(()=>[d(m(e.$t("reset")),1)]),_:1}),l(n(c),{variant:"outline-secondary",onClick:C},{default:r(()=>[l(n(L),{icon:"Printer",class:"w-4 h-4 mr-2"}),t[2]||(t[2]=d(" Print "))]),_:1}),l(n(c),{variant:"outline-secondary",onClick:k},{default:r(()=>t[3]||(t[3]=[d("CSV")])),_:1}),l(n(c),{variant:"outline-secondary",onClick:b},{default:r(()=>t[4]||(t[4]=[d("JSON")])),_:1}),l(n(c),{variant:"outline-secondary",onClick:A},{default:r(()=>t[5]||(t[5]=[d("XLSX")])),_:1}),l(n(c),{variant:"outline-secondary",onClick:z},{default:r(()=>t[6]||(t[6]=[d("HTML")])),_:1}),$(s("select",{"onUpdate:modelValue":t[1]||(t[1]=i=>f.value=i),class:"form-select ml-auto w-20"},[(g(),h(j,null,E([10,20,50,100],i=>s("option",{key:i,value:i},m(i),9,W)),64))],512),[[N,f.value]])]),s("div",q,[s("div",{ref_key:"tableRef",ref:v},null,512)])]))}});export{oe as default};
